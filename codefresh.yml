version: '1.0'
steps:
    build-step:
      type: build
      image_name: codefreshio/yaml-example
      dockerfile: Dockerfile
      tag: ${{CF_BRANCH}}

    step-file-generation:
      type: composition
      composition:
        version: '2'
        services:
          service-name:
            volumes:
              - ${{CF_VOLUME}}:/codefresh/volume
            image: ${{build-step}}
            command: bash -c "ls -l /codefresh/volume/cf-yml-examples/ && echo test:$MYSQL_ROOT_PASSWORD"
#            env_file: /codefresh/volume/cf-yml-examples/mysql.env
        volumes:
          ${{CF_VOLUME}}:
            external: true
      composition-candidates:
        test:
          image: ${{build-step}}
          command: echo test:$MYSQL_ROOT_PASSWORD
          env_file: /codefresh/volume/cf-yml-examples/mysql.env
          volumes:
            - ${{CF_VOLUME}}:/codefresh/volume
